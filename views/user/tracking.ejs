

<div class="st-appointment-areasa">
        <div id="tracking-container"></div>
        </div>
        
    <script>
        var datas = JSON.parse('<%- data %>');
        console.log(datas, "Daaaaaaaa");
    
        async function fetchStatus() {
            try {
                const trackingContainer = document.getElementById('tracking-container');
                trackingContainer.innerHTML = ''; // Clear previous tracking cards
    
                datas.forEach((order, index) => {
                    const trackingCard = createTrackingCard(order, index + 1);
                    trackingContainer.appendChild(trackingCard);
                });
    
            } catch (error) {
                console.error('Error fetching status:', error);
            }
        }
    
        function createTrackingCard(order, index) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.id = `tracking${index}`;
            let hasDeliveryArranged = false;
    
            let statusHTML = '';
            if (Array.isArray(order.statuses)) {
                order.statuses.forEach((status, statusIndex) => {
                    if (status.status === "Delivery arranged") {
                        hasDeliveryArranged = true;
                    }
                    statusHTML += `
                        <div class="step" id='step${index}-${statusIndex + 1}'>
                            <span class="icon">
                                <i class="bi bi-check"></i>
                            </span>
                            <span class="text">${status.status}</span>
                            <span class="text">${status.date}  ${status.comment !== null ?status.comment:""}</span>
                        </div>`;
                });
            } else {
                statusHTML += `<li class="step0" id="step${index}-1">${order.statuses}</li>`;
            }
    
            const firstStatusDate = Array.isArray(order.statuses) ? order.statuses[0].date : order.date;
    
            card.innerHTML = `
                <div class="info">
                    <div class="row">
                        <div class="col-7">
                            <span id="heading" style="color:#000">Date</span><br>
                            <span id="details" style="color:#000">${firstStatusDate}</span>
                        </div>
                        <div class="col-5 pull-right">
                            <span id="heading" style="color:#000">Box No.</span><br>
                            <span id="details" style="color:#000">${order.box_names}</span>
                        </div>
                    </div>
                    <div class="tracking">
                        <div class="title">Tracking Order</div>
                    </div>
                    <div class="track">
                        ${statusHTML}
                    </div>
                </div>
            `;
    
            if (hasDeliveryArranged) {
                const steps = card.querySelectorAll('.step');
                steps.forEach(step => step.classList.add('delivered'));
            } else {
                const steps = card.querySelectorAll('.step');
                steps.forEach(step => step.classList.add('active'));
            }
    
            return card;
        }
    
        // Fetch the status when the page loads
        window.onload = () => fetchStatus();
    </script>
    
    
    
    
    
    
    
    
    